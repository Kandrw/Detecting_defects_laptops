# Проект по автоматической детекции и классификации дефектов на ноутбуках

## Описание проекта

Проект представляет собой решение для автоматической детекции дефектов на изображениях ноутбуков и их классификации. Используя модель YOLO для детекции и EfficientNet для классификации, проект позволяет загружать изображения, определять наличие дефектов и классифицировать их. Результаты сохраняются в виде отчетов, которые могут быть использованы для проверки качества устройства.

## Структура проекта

```plaintext
hacaton/
│
├── configs/                          # Папка с конфигурационными файлами
│   ├── classification/
│   │   └── hyperparams.json           # Гиперпараметры для классификации
│   ├── detection/
│   │   └── hyperparams.json           # Гиперпараметры для детекции
│   └── data.yaml                      # Конфигурация данных для YOLO (разметка классов и пути к данным)
│
├── data/                              # Папка с исходными и разбитыми данными
│   ├── source/                        # Исходные данные (изображения и лейблы)
│   │   ├── images/                    # Изображения
│   │   └── labels/                    # Текстовые файлы лейблов (аннотации YOLO)
│   ├── train/                         # Тренировочные данные
│   ├── valid/                         # Валидационные данные
│   └── test/                          # Тестовые данные
│
├── models/                            # Папка с моделями
│   ├── classification.py              # Реализация модели классификации (EfficientNet)
│   ├── detection.py                   # Реализация модели детекции (YOLO)
│   └── save_model/                    # Папка для сохранения обученных моделей
│       ├── classification_model.pth   # Сохраненная модель классификации
│       └── detection_model.pth        # Сохраненная модель детекции
│
├── utils/                             # Вспомогательные утилиты
│   ├── custom_image_dataset.py        # Файл с реализацией кастомного датасета
│   ├── data_loader.py                 # Загрузчик данных для тренировки и валидации
│   ├── train_helper.py                # Вспомогательные функции для тренировки (сохранение и загрузка моделей)
│   └── split_data.py                  # Скрипт для разбиения данных на train/valid/test
│
├── runs/                              # Директория с результатами детекции YOLOv5
│
├── train.py                           # Основной файл для тренировки обеих моделей
├── run_predictions.py                 # Файл для прогноза по загруженному изображению
├── fine_tune.py                       # Скрипт для дообучения моделей на новых данных
├── split_data.py                      # Скрипт для разбиения данных перед обучением
├── requirements.txt                   # Список зависимостей для проекта
└── README.md                          # Описание проекта
```

## Требования
Для запуска проекта вам понадобится Python версии 3.8 или выше. Необходимые зависимости указаны в requirements.txt.

## Установка зависимостей
Убедитесь, что у вас установлен Python 3.8 или выше.

Создайте виртуальное окружение и активируйте его:

```plaintext
python3 -m venv venv
source venv/bin/activate  # Для Windows: venv\Scripts\activate
pip install -r requirements.txt
```
## Использование проекта
1. Разбиение данных на тренировочные, валидационные и тестовые наборы
Для начала, необходимо разбить исходные данные на тренировочные, валидационные и тестовые наборы:

```plaintext
python split_data.py
```
Этот скрипт автоматически создаст папки train/, valid/ и test/ в директории data/.

2. Обучение моделей
Для обучения моделей (как классификации, так и детекции), используйте файл train.py. Скрипт обучит обе модели на предоставленных данных.
```plaintext
python train.py
```
После завершения обучения веса моделей будут сохранены в папке models/save_model/.

3. Прогнозы на новых изображениях
Для того чтобы сделать прогноз на новых изображениях, используйте файл run_predictions.py:
```plaintext
python run_predictions.py --image <path_to_image>
```
Этот скрипт загрузит сохраненные модели из папки save_model/ и выведет результаты детекции и классификации на консоль.

4. Дообучение модели
Для дообучения модели на новых данных, используйте файл fine_tune.py:
```plaintext
python fine_tune.py
```



